# 2020年12月

## 2020/12/01

* 学习GPOPS使用

	求解一个状态变量的问题。

	求解6个状态变量的着陆问题，很难收敛，改变mesh.method，求解成功。

	可以用来做算例对比，需要明确其他参数的具体含义。

* LTGA

	服务器运行结果优化变量和目标函数值不对应，减少程序中的无用输出，观察PSO的过程输出，验证过程中的最优解是否正确。

	如果没有找到潜在的最优解，重新进行计算/增加种群数量。

	改用张楠的PSO程序进行简单计算，本机验证成功。

    在张楠的帮助下，比对两个PSO程序在并行模式下的不同，发现我之前所用的程序在并行部分使用了“全局变量”`index`，导致优化变量和目标函数值无法对应，所以出现了前面的错误。

## 2020/12/02

* STK

	HPOP仿真高精度轨道递推，生成轨道根数变化曲线/报告。

* LTGA

	从已知最优解中推导出6个优化变量的值，带入目标函数计算成功，说明通过对这6个变量进行搜索/优化，可以达到/接近间接法最优解。

	但最优解的变量超出了当前设置的范围，需要加大范围。

## 2020/12/03

* LTGA

	PSO运行结果。

	用NLOPT对PSO结果进行优化，结果很好。

* 阅读海洋师兄博士论文

## 2020/12/04

* LTGA

	重新整理LTGA的程序，对目标函数、PSO、NLOPT程序进行验证。

	输出最优解的推力曲线和轨迹，与《深空探测动力学与控制》书中曲线进行比对，完全一致。

	后续如果将双曲逃逸速度当作优化变量，仅需要增加2/3个优化变量，不需要重新推导一阶必要条件。

## 2020/12/05

* 探测133P

	将经由火星引力辅助探测133P的任务转化为6变量的目标函数，PSO没有找到可行解。

## 2020/12/07

* 探测133P

	直角坐标位置速度描述下，求解无引力辅助、末端固定、时间最优交会问题rv_top_rend_fixed，无法收敛。

	改用春分点轨道根数描述，可以收敛，存在局部最优解的情况。

	用春分点轨道根数求解6变量优化问题，目前没有找到可行解。

	为了寻找可行解：

	1. 以引力辅助时间为变量，求解两段Lambert问题速度增量，最小速度增量对应的解代入6变量目标函数，不是可行解。

	2. 第一段求解飞越问题，固定引力辅助半径和旋转角，求解单变量优化问题

		第二段时间最优交会问题总是不收敛，可能是变比冲导致的。

		将直角坐标转换为春分点轨道根数描述，仍然不收敛。

## 2020/12/08

* 改正探测133P程序中的错误

	第一段燃料最优飞越后的剩余质量

* 用郭铁丁博士论文中的算例验证LTGA的方法

	PSO搜索6变量优化问题，没有找到可行解。

* 6变量优化问题用于解决小推力引力辅助问题

	目前只成功求解了一个问题。

	1. 变量范围不好给定，很难找到可行解。

	2. 每一次都用间接法求解，时间很长，需要快速、准确地估计燃料消耗，并判断转移是否可行的方法。

## 2020/12/09

* 高等动力学大作业

	推导五连杆的第二类拉格朗日方程

	1. 要不要用其他方法求解动力学方程，如凯恩方程或者多体动力学中的RW方法

	2. 关节处控制力矩和广义力的关系

	3. 阅读文献，确定后续要做的内容，如步态规划/稳定性

## 2020/12/10

* 高等动力学大作业

	学习步态规划，首先给定一些运动特征，然后计算关节的运动方程，再计算各个广义坐标，然后计算关节处的力矩

	1. 采用连杆和竖直方向的夹角作广义坐标，对应的广义力和关节扭矩应该不相同，应该如何表示？

	2. 连杆和竖直方向的夹角的正负如何判定？

## 2020/12/11

* 高等动力学大作业

	重新定义广义坐标，以每个杆起点位置竖直向上的边作为始边，起点到终点作为终边，顺时针为正。

	在新的广义坐标下，重新推导第二类拉格朗日方程，方程形式变得统一且有规律。

	通过髋关节和踝关节的坐标计算广义坐标的值，角4和角5需要在论文的基础上加上pi。

## 2020/12/12

* 批改航天动力学相对运动作业

## 2020/12/14

* 航天动力学作业

	批改李锦堂作业，上传成绩，计算作业平均分。

* 高等动力学大作业

	根据髋关节和踝关节的轨迹计算广义坐标的值，公式在论文的基础上又做了一些改进。

	根据广义坐标值，通过数值微分计算一阶导数和二阶导数，端点处采用后向/前向差分，中间各点采用中心差分，二阶导数由一阶导数差分得到。

	由于广义坐标定义不同，后两个广义坐标和论文中相差一个pi，但曲线走势相同。

	后两个广义坐标的一阶导数和二阶导数曲线与论文中不同，论文中的曲线很明显有误。

* LTGA

	采用书上已经成功的算例，重新规定6个变量的搜索范围，引力辅助时间为0-1，固定引力辅助半径和旋转角，第一段末端相对速度大小的3个分量范围为[-0.1,0.1]，随机搜索500次，可以得到可行解。

	> 上述结果说明：不需要对变量范围进行过多限制，即可搜索到可行解，然后根据可行解改变搜索范围，进行进一步的优化，即可得到最优解。

	但是对于地球-地球-木星的算例，仍然没有得到可行解，是否因为本身就没有可行解，因为论文中提到了发射速度，但我在计算的时候并没有考虑，但论文中的结果和发射速度的处理方法都不明确，无法查证。

## 2020/12/15

* 高等动力学大作业

	根据广义坐标及其一阶导数和二阶导数，结合第二类拉格朗日方程，计算广义力，并转换为驱动力矩。

* LTGA

	将地球-地球-木星问题的转移时间改为6年，随机搜索可以得到可行解。

* 准备讨论班PPT，规划所需算例

	单变量优化：相对速度旋转角取正负pi/2，分别进行网格搜索。

## 2020/12/16

* 准备讨论班PPT，规划所需算例

	* 单变量优化

		相对速度旋转角为-pi/2时，网格搜索没有可行解

		相对速度旋转角为pi/2时，引力辅助时间在0.30-0.35之间是可行的

		以0.34作为初值，用NLOPT进行局部优化。

		在旋转角为pi/2的情况下，对引力辅助时间从0.3-0.35进行网格搜索，间隔为0.001，用MATLAB作出剩余质量随factor的变化曲线。

	* 三变量优化

		进行网格搜索，引力辅助时间为[0,1]tf，引力辅助半径为[1,2]rmin，相对速度旋转角为[0,2pi]，网格数分别为10、10、20，采用并行计算。

    	并行计算结果顺序错乱，用MATLAB进行排序。

    	精细化网格搜索。

    	全范围PSO、NLOPT局部优化

## 2020/12/17

* 准备讨论班PPT

	[-0.1,0.1]，6变量PSO、NLOPT（分别用初始可行解和最终结果做初值）

	[-0.2,0.2]，6变量PSO

* 高等动力学大作业

	静态稳定性、动态稳定性。

	论文中没有给出脚掌长度，ZMP点轨迹与论文中不同。

## 2020/12/18

* 讨论班

	如何确定内层变量/外层变量？

	首先要有一个总体的思路，这个问题要如何求解，有哪些变量，根据变量的类型划分为外层和内层，外层和内层分别对一种类型的变量进行优化。

	外层-离散变量，内层-连续变量

	外层-若干个连续变量，内层-无穷维最优控制问题

* 宋雨师兄 并行生成数据集

	每个线程根据循环变量i的值建立txt文件，用于存放生成的数据。

	每个线程根据循环变量i的值设置随机数种子。

	由于并行程序中不能含有break语句，因此不收敛的数据也需要进行输出，可以用于构建分类神经网络，判断转移是否可行。

* 阅读文献 Machine learning and evolutionary techniques in interplanetary trajectory design

## 2020/12/20

* 高等动力学大作业

	推导相对转角为广义坐标时的动力学方程

## 2020/12/21

* 高等动力学大作业

	完成公式推导。

	分析方程中各项的物理意义

	PPT制作

## 2020/12/22

* 高等动力学大作业

	汇报 下午一点到五点

	撰写报告

## 2020/12/23

* 技术方案

	化学推力和连续推力联合规划

	the combination of chemical engines for planetary flight and electrical engines for interplanetary flight

	本质上还是分段规划