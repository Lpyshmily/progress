# 2021年3月

## 2021/03/01

* 应用DNN输出的神经网络模型参数，进行集束搜索

	输入变量的顺序是：初始质量、初始轨道春分点轨道根数、末端轨道春分点轨道根数。

	问题描述：初始质量2000kg，从任意一颗小行星出发，最短时间访问5颗小行星。

	参数设置：

	```c++
    bw = 10000; // 集束宽度
    bf = 100; // 每个结点拓展的子结点个数
    GoodNumber = 20; // 最终保留的较优序列个数
    ```

	运行时间：10433.5秒，约为2.9小时。

	运行结果：

	* 预测时间均大于实际时间，与神经网络训练结果相符

    * 实际排名与预测排名之间相关性比较差，实际排名前5名均位于预测排名5名以后，预测第1名实际仅为17名

    * **实际排名越靠前，总用时误差越大**

    总而言之，神经网络预测效果较差仍是最需要改进的问题。

    后面的计划是，用相同的神经网络+其他搜索算法，搜索序列

* 处理上周末生成的数据集

	加入剔除条件：初末轨道真经度之差>pi/2，角动量质量夹角余弦值<0.85

    增加输出信息：两组直角坐标位置速度

    使用服务器同时运行20个程序，共生成200000条数据。

    * 数据集分析

		旧的数据集（10万）中，转移时间小于5的有690条，转移时间小于3的有19条。

		新的数据集（20万）中，转移时间小于5的有2508条，转移时间小于3的有49条，相比之下转移时间短的数据所占比例增加，但增加幅度较小。

	* 轨道根数与最优转移时间之间的关系

		仍然只有`dL`、`cos_theta`和tof之间有较为明显的关系，`dh`角动量大小之差和tof之间的关系不够明显，其余各量几乎看不出与tof的相关性。

	* 训练神经网络，比较平均相对误差

		输入变量为：初始质量+直角坐标位置速度+dE+dh（海洋师兄论文中采用的），train_loss: 0.029079, valid_loss: 0.035159, test_loss: 0.035331

		输入变量为：初始质量+春分点轨道根数+dL+轨道面夹角余弦，train_loss: 0.018703, valid_loss: 0.023844, test_loss: 0.023458

		第二种输入变量效果更好，预计调参之后可以得到更好的效果。

		采用第二个神经网络进行分析：相对误差大于50%的数据仅有7条，仍然是预测值大于真实值。

* 学习其他序列优化算法（海洋师兄博士论文）

	* 进化精英算法：蚁群算法+进化算法

	* 混合变量进化精英算法：将启发因子和信息素视为时间的函数，给出其计算方法和积分方法

## 2021/03/02

* 与之前搜索结果进行比较

	数据集1：10万条数据，按照海洋师兄的方法生成，真实天体，剔除条件为da、di、dL

	数据集2：10万条数据，虚拟天体，自定义6个轨道根数范围，不加剔除条件

	采用数据集1、训练神经网络、集束搜索得到20条序列，访问5颗小行星的预测时间为850天左右，实际时间为750-900天。

	采用数据集2、训练神经网络、集束搜索得到20条序列，访问5颗小行星的预测时间为1415天左右，实际时间为1220-1340天。

	用新的神经网络2对旧的序列1进行预测，预测结果远大于真实结果，说明新的神经网络+集束搜索无法找到转移时间短的序列。

* 生成数据集和集束搜索时所使用的提出条件必须一致

	如何选取这个剔除条件，使得剔除后的空间中两颗小行星之间的转移时间较短？

* 分析影响最优转移时间的因素

	数据集3：20万条数据，虚拟天体，自定义6个轨道根数范围，剔除条件dL、cos_theta

	dr、dv与最优转移时间之间存在着较为明显的关系，可以作为剔除条件，在生成数据集/集束搜索时使用

	数据集1中转移时间小于5的有4597条，而数据集2中仅有690条，数据集3中仅有2508条，数据集1中比例更高

	原因是数据集1的生成过程中剔除条件非常严格

* 学习蚁群算法TSP问题

	阅读文献 Ant system: Optimization by a colony of cooperating agents

	C++代码：（128-134行）按概率选取下一个城市的方法比较独特（对于每个可能的选择，产生随机数判断是否选择，如果选择，则进行下一步），不同于以往（先计算累积概率，然后产生一个随机数进行选取）

	MATLAB代码：主程序54-56行不明白在做什么

* 重新生成top数据集4

    生成数据集和集束搜索采用的搜索范围要保持一致。

    1. 集束搜索时只选用偏心率小于0.1的，因此生成数据集时偏心率的范围应该是[0,0.1]

    2. 剔除条件：dL>pi/2，cos_theta<0.85，dr>2.0，dv>1.0

    本机生成10000条，用时24163秒，约6.67小时。

## 2021/03/03

* 最优转移时间影响因素分析

	t-SNE、PCA，没有得到好的结果，对这一方面的想法也不是特别清晰。

	最优转移时间本质上是一个非线性很强的函数，与自变量之间的关系很难解释清楚。

* 继续学习海洋师兄博士论文第四章的算法

	计划用数据集1生成的神经网络（初始质量为1000-2000kg）+多种序列优化算法进行实现。

* 编写随机集束搜索代码

	用mode参数进行区分，`mode=0`表示确定性集束搜索，`mode=1`表示随机集束搜索。

	* 小规模计算验证确定性集束搜索不受影响

	```c++
    mode = 0;
    const int SeqLength = 2;
    const int GoodNum = 2;
    const int BW = 10;
    const int BF = 100;
    ```

    运行时间1783秒，约0.5小时。

    * 小规模计算验证随机集束搜索

    	结果与确定性集束搜索相同，预计大规模计算中会有差别。

* 与张楠讨论

	时变TSP有以下两种类型：

	1. 序列确定之后，每一段的“距离”和总的指标就会唯一确定，对应多目标时间最优问题，如果序列确定，那么每一段求解时间最优问题得到转移时间，即可得到当前序列对应的最优转移时间；

	2. 序列确定之后，每一段的“距离”还会受到一个连续变量的影响，因此还需要对这些连续变量进行全局优化，才能得到最优解，对应多目标燃料最优问题，如果序列确定，还需要确定每一段的转移时间，对这些转移时间进行优化之后，才能得到当前序列对应的燃料最优解。

## 2021/03/04

* 学习Linux系统下C++编程

	编写CMakeLists.txt文件，使用CMake对程序进行编译，并运行。

	测试间接法求解地球到火星燃料最优问题，可以准确求解。

## 2021/03/05

阅读文献 The hybridization of ACO + GA and RVNS algorithm for solving the time-dependent traveling salesman problem

由于服务器占用，进度受到影响。

阅读文献 Co-state initialization for the minimum-time low-thrust trajectory optimization